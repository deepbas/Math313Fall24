{
  "hash": "b999ea194d4721aeec155bded8ae8a58",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Day 40\"\ntitle-slide-attributes:\n  data-background-image: images/lake.jpg\n  data-background-size: contain\n  data-background-opacity: \"0.5\"\nsubtitle: \"MATH 313: Survey Design and Sampling\"\nauthor: \"\"\nformat:\n  revealjs:\n    html-math-method: mathjax\n    mathjax-url: \"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/MathJax.js\"\n    theme: [default, scss/main.scss]\n    slide_level: 2\n    slide-number: true\n    preview-links: auto\n    history: true\n    chalkboard: \n      src: chalkboard.json\n      eraser:\n        src: 'img/sponge.png'\n        radius: 20\n    transition: slide\n    background-transition: fade    \n    touch: false\n    controls: true\n---\n\n\n\n\n\n## Introduction to Survey Weights {.font80}\n\n::: cle6\n\n- **Complex Sampling Designs** often involve:\n  - Stratification, Clustering, Unequal probabilities of selection\n  - Multiple stages of selection, Systematic selection\n- Usual estimation and testing procedures may not be appropriate due to these features.\n\n:::\n\n## Importance of Weights {.font80}\n\n::: cle12\n- **Unbiased Estimates**: Weights correct for variable probabilities of selection.\n- **Precision of Estimates**: Adjust variance estimators to reflect complex sample designs.\n- **Adjustments for Nonresponse**: Increase weights for responding units to account for non-respondents.\n- **Benchmarking**: Adjust survey estimates to external census estimates.\n\n:::\n\n\n## Weighting in Practice vs Theory {.font80}\n\n::: cle12\n- **Theoretical Background**: Unbiased estimator of a population total: \n  $$\\frac{N}{n} \\sum_{i=1}^{n} y_{i}$$\n  - $N$: Population size, $n$: Sample size, $y_i$: Sample observations\n- **Practical Application**: Focus is on constructing the actual weights to use in analysis.\n\n:::\n\n## Case Study: Housing Permits in Florida {.font80}\n\n::: cle12\n- **Objective**: Estimate total building permits in FL in 2000 from a sample.\n- **Method**: Sample 10 of Florida's 67 counties, using area as a proxy for sampling probability.\n\n:::\n\n##  Data Example: Florida Counties {.font80}\n\n\n<img src=\"images/Day40-1.png\" style=\"display: block; margin: auto;\" width=\"70%\"  loading=\"lazy\" decoding=\"async\">\n\n\n## Analysis Using Survey Weights {.font80}\n\n::: cle12\n- **Weights**: Inverse of the probability proportional to area, $w_i=1 / A_i$\n- **Weighted Estimate**:\n  $$\\hat{\\mu} = \\frac{\\sum w_{i} y_{i}}{\\sum w_{i}}$$\n- **Variance**:\n  - Standard errors calculated using ratio estimator techniques.\n\n:::\n\n## {.font60}\n\n> Example 11.6 Textbook: This study aims to estimate the total number of housing unit building permits issued in Florida in 2000 by analyzing a sample from ten of the state's 67 counties. The counties were selected randomly, and data on the number of approved building permits and county area in square miles were recorded. These measures are sourced from census data. The total area for all counties is not known for this example, and the data will be used to calculate the estimate and its standard error.\n\n##\n\n## Discussion: API Dataset (R) {.font80}\n\n::: cle12\n- **Dataset**: From the `survey` package, includes student achievement and demographic data.\n- **Application**: Demonstrate how weights can adjust for school size and demographic biases in educational data analysis.\n\n:::\n\n\n## {.font25}\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |         |\n|:------------------------|:--------|\n|Name                     |apistrat |\n|Number of rows           |200      |\n|Number of columns        |39       |\n|_______________________  |         |\n|Column type frequency:   |         |\n|numeric                  |28       |\n|________________________ |         |\n|Group variables          |None     |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|      sd|     p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-------:|------:|-------:|-------:|-------:|-------:|:-----|\n|snum          |         0|          1.00| 3077.27| 1841.20| 114.00| 1495.25| 3022.50| 4688.00| 6173.00|▇▆▇▆▇ |\n|dnum          |         0|          1.00|  444.71|  211.24|  19.00|  259.00|  453.50|  627.75|  825.00|▃▆▇▇▅ |\n|cnum          |         0|          1.00|   27.32|   14.55|   1.00|   18.00|   29.00|   37.00|   56.00|▃▇▅▆▃ |\n|flag          |       200|          0.00|     NaN|      NA|     NA|      NA|      NA|      NA|      NA|      |\n|pcttest       |         0|          1.00|   98.11|    3.76|  66.00|   98.00|   99.00|  100.00|  100.00|▁▁▁▁▇ |\n|api00         |         0|          1.00|  652.82|  120.97| 398.00|  555.25|  658.50|  743.25|  893.00|▃▆▇▆▃ |\n|api99         |         0|          1.00|  624.82|  124.56| 383.00|  525.75|  626.00|  707.50|  890.00|▅▇▇▆▃ |\n|target        |        20|          0.90|   10.00|    5.32|   1.00|    6.00|   10.00|   14.00|   21.00|▇▇▇▆▃ |\n|growth        |         0|          1.00|   28.00|   28.12| -47.00|    6.75|   25.00|   48.00|  133.00|▁▇▇▂▁ |\n|meals         |         0|          1.00|   44.99|   28.97|   0.00|   20.75|   39.50|   69.00|  100.00|▇▇▆▆▅ |\n|ell           |         0|          1.00|   20.94|   19.77|   0.00|    5.00|   16.00|   32.25|   84.00|▇▅▂▁▁ |\n|mobility      |         0|          1.00|   16.40|   12.12|   1.00|   10.00|   14.00|   19.00|   99.00|▇▂▁▁▁ |\n|acs.k3        |       103|          0.48|   19.16|    1.22|  16.00|   18.00|   19.00|   20.00|   24.00|▁▇▅▁▁ |\n|acs.46        |        66|          0.67|   28.86|    3.42|  20.00|   27.00|   29.00|   31.00|   46.00|▂▇▃▁▁ |\n|acs.core      |        94|          0.53|   27.37|    3.18|  15.00|   26.00|   28.00|   29.00|   35.00|▁▂▇▇▂ |\n|pct.resp      |         0|          1.00|   72.31|   31.51|   0.00|   63.75|   86.00|   94.25|  100.00|▂▁▁▂▇ |\n|not.hsg       |         0|          1.00|   17.66|   17.13|   0.00|    3.00|   12.00|   26.25|   75.00|▇▃▂▁▁ |\n|hsg           |         0|          1.00|   22.86|   15.11|   0.00|   14.75|   22.00|   30.00|  100.00|▇▇▁▁▁ |\n|some.col      |         0|          1.00|   22.96|   11.21|   0.00|   15.75|   24.00|   31.00|   50.00|▃▆▇▆▁ |\n|col.grad      |         0|          1.00|   21.38|   14.25|   0.00|   10.00|   21.00|   31.00|  100.00|▇▇▁▁▁ |\n|grad.sch      |         0|          1.00|    9.72|   11.71|   0.00|    2.00|    6.00|   12.00|   55.00|▇▂▁▁▁ |\n|avg.ed        |         0|          1.00|    2.81|    0.69|   1.38|    2.29|    2.82|    3.31|    4.44|▃▆▇▅▂ |\n|full          |         0|          1.00|   86.60|   13.57|  24.00|   81.00|   91.00|   97.00|  100.00|▁▁▁▃▇ |\n|emer          |         0|          1.00|   12.21|   12.11|   0.00|    3.00|    9.00|   17.00|   72.00|▇▂▁▁▁ |\n|enroll        |         0|          1.00|  746.68|  549.93| 119.00|  363.75|  554.50|  961.25| 3156.00|▇▂▁▁▁ |\n|api.stu       |         0|          1.00|  619.07|  462.32| 106.00|  310.50|  459.00|  780.75| 2900.00|▇▂▁▁▁ |\n|pw            |         0|          1.00|   30.97|   13.40|  15.10|   19.05|   32.28|   44.21|   44.21|▇▁▁▁▇ |\n|fpc           |         0|          1.00| 2653.75| 1774.14| 755.00|  952.25| 2719.50| 4421.00| 4421.00|▇▁▁▁▇ |\n\n\n:::\n:::\n\n\n\n\n\n## Implementation in R {.font80}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survey)\ndata(api)\n# Create survey design without weights\nstrat_design <- svydesign(ids = ~1, data = apistrat)\n\n# Create survey design with weights\nweighted_design <- svydesign(ids = ~1, weights = ~pw, data = apistrat)\n\n# Estimate mean without weights\nmean_srs <- svymean(~api00, strat_design)\nmean_srs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        mean    SE\napi00 652.82 8.554\n```\n\n\n:::\n\n```{.r .cell-code}\n# Estimate mean with weights\nmean_weighted <- svymean(~api00, weighted_design)\nmean_weighted\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        mean     SE\napi00 662.29 9.5854\n```\n\n\n:::\n:::\n\n\n\n## Summary: Key Concepts in Survey Weighting {.font60}\n\n::: cle14\n- **Discussion**: Weights adjust for sampling design and population structure, often providing a more representative estimate of the population mean.\n- **Data Preparation**:\n  - **Cleaning and Validation**: Remove errors and standardize data formats.\n  - **Handling Outliers and Missing Data**: Implement strategies to ensure quality data input.\n- **Identifying Weighting Variables**:\n  - **Key Factors**: Age, gender, income, education, location.\n  - **Sources**: Use census data and other reliable demographic sources.\n- **Calculating Weighting Factors**:\n  - **Stratification**: Align sample distribution with population.\n  - **Raking**: Iteratively adjust weights to match population characteristics.\n  - **Calibration**: Adjust sample weights using known population totals.\n:::\n\n## {.font50}\n\n> Example2 : Scientists studying fish consumption in a specified body of water periodically sent field workers out to interview everyone fishing in that water in those selected periods. Among other variables, the field-workers collected data on the amount of fish from that water the person consumed over the past month and the number of times the person fished in that water over the survey period (see the accompanying table). One goal of the study is to estimate the mean amount of fish consumed over the past month per person fishing in that body of water. Find and justify a reasonable estimate of this mean and provide a margin of error for the estimate.\n\n<img src=\"images/Day40-2.png\" style=\"display: block; margin: auto;\" width=\"70%\"  loading=\"lazy\" decoding=\"async\">\n\n##  {.font80}\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}